{
  "$schema": "../../../schema/2025-draft/neuro.schema.json",
  "metadata": {
    "model": {
      "name": "model_config",
      "version": "1.0.0",
      "description": "Shared configuration constants and definitions for multimodal models",
      "author": "NeuroFormat Team",
      "license": "MIT",
      "tags": ["config", "constants", "shared"],
      "modalities": {
        "inputs": ["custom"],
        "outputs": ["custom"]
      }
    }
  },
  "inputs": [],
  "outputs": [],
  "constants": [
    {
      "name": "fusion_dimension",
      "type": "scalar",
      "value": 512
    },
    {
      "name": "output_classes",
      "type": "scalar",
      "value": 1000
    },
    {
      "name": "attention_heads",
      "type": "scalar",
      "value": 8
    },
    {
      "name": "dropout_rate",
      "type": "scalar",
      "value": 0.1
    }
  ],
  "definitions": [
    {
      "name": "multihead_attention",
      "type": "sequential",
      "arguments": [
        { "name": "query", "type": "tensor" },
        { "name": "key", "type": "tensor" }
      ],
      "attributes": {
        "num_heads": "@{constants/attention_heads}",
        "embed_dim": "@{constants/fusion_dimension}"
      },
      "subgraph": [
        {
          "name": "attention_output",
          "type": "multi_head_attention",
          "arguments": ["@{inputs.query}", "@{inputs.key}"],
          "attributes": {
            "heads": "@{constants/num_heads}",
            "dim": "@{constants/embed_dim}"
          }
        }
      ],
      "outputs": [
        {
          "name": "attended_features",
          "description": "Multi-head attention output",
          "source": "@{attention_output}"
        }
      ]
    },
    {
      "name": "attention_extractor",
      "type": "sequential",
      "arguments": [{ "name": "features", "type": "tensor" }],
      "subgraph": [
        {
          "name": "attention_weights",
          "type": "identity",
          "arguments": ["@{inputs.features}"]
        }
      ],
      "outputs": [
        {
          "name": "extracted_features",
          "description": "Identity-transformed features for attention extraction",
          "source": "@{attention_weights}"
        }
      ]
    }
  ],
  "export": []
}
